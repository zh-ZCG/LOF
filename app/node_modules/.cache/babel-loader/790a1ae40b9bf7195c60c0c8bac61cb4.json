{"remainingRequest":"D:\\huayu\\app\\node_modules\\babel-loader\\lib\\index.js!D:\\huayu\\app\\src\\router\\index.js","dependencies":[{"path":"D:\\huayu\\app\\src\\router\\index.js","mtime":1651799624767},{"path":"D:\\huayu\\app\\babel.config.js","mtime":1650456648521},{"path":"D:\\huayu\\app\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1650797765123},{"path":"D:\\huayu\\app\\node_modules\\babel-loader\\lib\\index.js","mtime":1650797766823}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9hc3luY1RvR2VuZXJhdG9yIGZyb20gIkQ6L2h1YXl1L2FwcC9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vYXN5bmNUb0dlbmVyYXRvci5qcyI7CmltcG9ydCAicmVnZW5lcmF0b3ItcnVudGltZS9ydW50aW1lLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMucmVnZXhwLmV4ZWMuanMiOwovLyDphY3nva7ot6/nlLEKaW1wb3J0IFZ1ZSBmcm9tICd2dWUnOwppbXBvcnQgVnVlUm91dGVyIGZyb20gJ3Z1ZS1yb3V0ZXInOyAvL+S9v+eUqOaPkuS7tgoKVnVlLnVzZShWdWVSb3V0ZXIpOyAvL+W8leWFpei3r+eUsee7hOS7tgoKaW1wb3J0IHJvdXRlcyBmcm9tICcuL3JvdXRlcyc7CmltcG9ydCBzdG9yZSBmcm9tICJAL3N0b3JlIjsgLy/lpIfku73ljp/lnovlr7nosaHnmoRwdXNoCgp2YXIgb3JpZ2luUHVzaCA9IFZ1ZVJvdXRlci5wcm90b3R5cGUucHVzaDsKdmFyIG9yaWdpblJlcGxhY2UgPSBWdWVSb3V0ZXIucHJvdG90eXBlLnJlcGxhY2U7IC8v6YeN5YaZcHVzaHxyZXBsY2UKClZ1ZVJvdXRlci5wcm90b3R5cGUucHVzaCA9IGZ1bmN0aW9uIChsb2NhdGlvbiwgcmVzb2x2ZSwgcmVqZWN0KSB7CiAgaWYgKHJlc29sdmUgJiYgcmVqZWN0KSB7CiAgICBvcmlnaW5QdXNoLmNhbGwodGhpcywgbG9jYXRpb24sIHJlc29sdmUsIHJlamVjdCk7CiAgfSBlbHNlIHsKICAgIG9yaWdpblB1c2guY2FsbCh0aGlzLCBsb2NhdGlvbiwgZnVuY3Rpb24gKCkge30sIGZ1bmN0aW9uICgpIHt9KTsKICB9Cn07CgpWdWVSb3V0ZXIucHJvdG90eXBlLnJlcGxhY2UgPSBmdW5jdGlvbiAobG9jYXRpb24sIHJlc29sdmUsIHJlamVjdCkgewogIGlmIChyZXNvbHZlICYmIHJlamVjdCkgewogICAgb3JpZ2luUmVwbGFjZS5jYWxsKHRoaXMsIGxvY2F0aW9uLCByZXNvbHZlLCByZWplY3QpOwogIH0gZWxzZSB7CiAgICBvcmlnaW5SZXBsYWNlLmNhbGwodGhpcywgbG9jYXRpb24sIGZ1bmN0aW9uICgpIHt9LCBmdW5jdGlvbiAoKSB7fSk7CiAgfQp9OwoKdmFyIHJvdXRlciA9IG5ldyBWdWVSb3V0ZXIoewogIHJvdXRlczogcm91dGVzLAogIHNjcm9sbEJlaGF2aW9yOiBmdW5jdGlvbiBzY3JvbGxCZWhhdmlvcih0bywgZnJvbSwgc2F2ZVBvc2l0aW9uKSB7CiAgICByZXR1cm4gewogICAgICB4OiAwLAogICAgICB5OiAwCiAgICB9OwogIH0KfSk7CnJvdXRlci5iZWZvcmVFYWNoKCAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkgewogIHZhciBfcmVmID0gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlKHRvLCBmcm9tLCBuZXh0KSB7CiAgICB2YXIgdG9rZW4sIHBob25lLCB0b1BhdGg7CiAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZSQoX2NvbnRleHQpIHsKICAgICAgd2hpbGUgKDEpIHsKICAgICAgICBzd2l0Y2ggKF9jb250ZXh0LnByZXYgPSBfY29udGV4dC5uZXh0KSB7CiAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgIHRva2VuID0gc3RvcmUuc3RhdGUudXNlci50b2tlbjsKICAgICAgICAgICAgcGhvbmUgPSBzdG9yZS5zdGF0ZS51c2VyLnBob25lOwoKICAgICAgICAgICAgaWYgKCF0b2tlbikgewogICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAyNDsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYgKCEodG8ucGF0aCA9PSAiL2xvZ2luIiB8fCB0by5wYXRoID09ICcvcmVnaXN0ZXInKSkgewogICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSA3OwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CgogICAgICAgICAgICBuZXh0KCcvJyk7CiAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAyMjsKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgY2FzZSA3OgogICAgICAgICAgICBpZiAoIXBob25lKSB7CiAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDExOwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CgogICAgICAgICAgICBuZXh0KCk7CiAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAyMjsKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgY2FzZSAxMToKICAgICAgICAgICAgX2NvbnRleHQucHJldiA9IDExOwogICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMTQ7CiAgICAgICAgICAgIHJldHVybiBzdG9yZS5kaXNwYXRjaCgnZ2V0VXNlckluZm8nKTsKCiAgICAgICAgICBjYXNlIDE0OgogICAgICAgICAgICBuZXh0KCk7CiAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAyMjsKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgY2FzZSAxNzoKICAgICAgICAgICAgX2NvbnRleHQucHJldiA9IDE3OwogICAgICAgICAgICBfY29udGV4dC50MCA9IF9jb250ZXh0WyJjYXRjaCJdKDExKTsKICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDIxOwogICAgICAgICAgICByZXR1cm4gc3RvcmUuZGlzcGF0Y2goJ3VzZXJMb2dvdXQnKTsKCiAgICAgICAgICBjYXNlIDIxOgogICAgICAgICAgICBuZXh0KCcvbG9naW4nKTsKCiAgICAgICAgICBjYXNlIDIyOgogICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMjY7CiAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgIGNhc2UgMjQ6CiAgICAgICAgICAgIHRvUGF0aCA9IHRvLnBhdGg7CgogICAgICAgICAgICBpZiAodG9QYXRoLmluZGV4T2YoJy90cmFkZScpICE9IC0xIHx8IHRvUGF0aC5pbmRleE9mKCcvcGF5JykgIT0gLTEgfHwgdG9QYXRoLmluZGV4T2YoJy9jZW50ZXInKSAhPSAtMSkgewogICAgICAgICAgICAgIC8v5oqK5pyq55m75b2V55qE5pe25YCZ5ZCR5Y676ICM5rKh5pyJ5Y675oiQ55qE5L+h5oGv77yM5a2Y5YKo5LqO5Zyw5Z2A5qCP5Lit44CQ6Lev55Sx44CRCiAgICAgICAgICAgICAgbmV4dCgnL2xvZ2luP3JlZGlyZWN0PScgKyB0b1BhdGgpOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIC8v5Y6755qE5LiN5piv5LiK6Z2i6L+Z5Lqb6Lev55Sx77yIaG9tZXxzZWFyY2h8c2hvcENhcnTvvIktLS3mlL7ooYwKICAgICAgICAgICAgICBuZXh0KCk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICBjYXNlIDI2OgogICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LnN0b3AoKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0sIF9jYWxsZWUsIG51bGwsIFtbMTEsIDE3XV0pOwogIH0pKTsKCiAgcmV0dXJuIGZ1bmN0aW9uIChfeCwgX3gyLCBfeDMpIHsKICAgIHJldHVybiBfcmVmLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgfTsKfSgpKTsKZXhwb3J0IGRlZmF1bHQgcm91dGVyOw=="},{"version":3,"sources":["D:/huayu/app/src/router/index.js"],"names":["Vue","VueRouter","use","routes","store","originPush","prototype","push","originReplace","replace","location","resolve","reject","call","router","scrollBehavior","to","from","savePosition","x","y","beforeEach","next","token","state","user","phone","path","dispatch","toPath","indexOf"],"mappings":"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","sourcesContent":["// 配置路由\r\nimport Vue from 'vue';\r\nimport VueRouter from 'vue-router';\r\n//使用插件\r\nVue.use(VueRouter);\r\n//引入路由组件\r\nimport routes from './routes';\r\nimport store from \"@/store\";\r\n\r\n//备份原型对象的push\r\nlet originPush = VueRouter.prototype.push;\r\nlet originReplace = VueRouter.prototype.replace;\r\n//重写push|replce\r\nVueRouter.prototype.push = function (location, resolve, reject) {\r\n    if (resolve && reject) {\r\n        originPush.call(this, location, resolve, reject)\r\n    } else {\r\n        originPush.call(this, location, () => { }, () => { });\r\n    }\r\n}\r\nVueRouter.prototype.replace = function (location, resolve, reject) {\r\n    if (resolve && reject) {\r\n        originReplace.call(this, location, resolve, reject)\r\n    } else {\r\n        originReplace.call(this, location, () => { }, () => { });\r\n    }\r\n}\r\n\r\n\r\nlet router =  new VueRouter({\r\n    routes,\r\n    scrollBehavior(to, from, savePosition) {\r\n        return { x: 0, y: 0 };\r\n    }\r\n})\r\n\r\nrouter.beforeEach(async (to, from, next) => {\r\n    let token = store.state.user.token;\r\n    let phone = store.state.user.phone;\r\n    if (token) {\r\n        if (to.path == \"/login\" || to.path == '/register') {\r\n            next('/');\r\n        } else {\r\n            //已经登陆了,访问的是非登录与注册\r\n            //登录了且拥有用户信息放行\r\n            if (phone) {\r\n                next();\r\n            } else {\r\n                //登陆了且没有用户信息\r\n                //在路由跳转之前获取用户信息且放行\r\n                try {\r\n                    await store.dispatch('getUserInfo');\r\n                    next();\r\n                } catch (error) {\r\n                    //token失效从新登录\r\n                    await store.dispatch('userLogout');\r\n                    next('/login')\r\n                }\r\n            }\r\n        }\r\n    } else {\r\n        let toPath = to.path;\r\n        if (toPath.indexOf('/trade') != -1 || toPath.indexOf('/pay') != -1 || toPath.indexOf('/center') != -1) {\r\n            //把未登录的时候向去而没有去成的信息，存储于地址栏中【路由】\r\n            next('/login?redirect=' + toPath);\r\n        } else {\r\n            //去的不是上面这些路由（home|search|shopCart）---放行\r\n            next();\r\n        }\r\n\r\n    }\r\n});\r\n\r\nexport default router;"]}]}